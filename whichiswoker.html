<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Load Excel Data</title>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Bungee&display=swap" rel="stylesheet">

    <style>

.bungee-regular {
  font-family: "Bungee", sans-serif;
  font-weight: 400;
  font-style: normal;
}


#dataTable {


display:none;

}

body {

background-image: url("images/gradient.jpg");

background-size: cover;

background-repeat:no-repeat;


}

#container {

display:flex;

}

#myImage {

position:relative;
margin-top:10%;
left: 30%;
right: 70%;
transform: translate(-50%, -50%);
height: 30%;
width: 30%;
border-color: black;
border-radius: 2%;
border: 5px solid black;
margin-bottom: -5%;

}

#myImage1 {

position:relative;
margin-top:10%;
left: 40%;
right: 30%;
transform: translate(-50%, -50%);
height: 30%;
width: 30%;
border-color: black;
border-radius: 2%;
border: 5px solid black;
margin-bottom: -5%;

}

#header {
  
max-width: 1080px;      
margin: 0 auto;        
text-align: center;    
white-space: normal;   
word-break: normal;    
margin-top: 3%;
font-family:"Bungee";
font-size:30px;
}

#wokes {

    display:flex;
}

#isWoke {


max-width: 200px;      
margin: 0 auto;        
text-align: center;    
white-space: normal;   
word-break: normal;    
margin-top: 1%;
font-family:"Bungee";
font-size:10px;
}

#isWoke1 {


max-width: 200px;      
margin: 0 auto;        
text-align: center;    
white-space: normal;   
word-break: normal;    
margin-top: 1%;
font-family:"Bungee";
font-size:10px;
}

#note {

max-width: 600px;      
margin: 0 auto;        
text-align: center;    
white-space: normal;   
word-break: normal;    
margin-top: 1%;
font-family:"Bungee";
font-size:16px;

}

#score {

max-width: 600px;      
margin: 0 auto;        
text-align: center;    
white-space: normal;   
word-break: normal;    
margin-top: 2%;
font-family:"Bungee";
font-size:30px;

}

#buttons {

max-width: 1000px;      
margin: 0 auto;        
text-align: center;    
white-space: normal;   
word-break: normal;    
margin-top: 2%;
font-family:"Bungee";

}



#next {


font-family:"Bungee";
background-color: white;
font-size:12px;
display: inline-block;
 padding: 12px 24px;
 margin-left: 2%;

}


    </style>
</head>


<body>
    <h1 id="header">which is woker?</h1>
    
    <div id = "buttons">

  

    <button onclick="myrefresh()" id = "next">next</button>

   </div>

   <div class = "container">

    <a><img onclick="imgTest(0)" id = "myImage" class = "theImage" src = "https://shared.fastly.steamstatic.com/store_item_assets/steam/apps/2246340/header_292x136.jpg?t=1759120729"></a>

    <a><img onclick="imgTest(1)" id = "myImage1" class = "theImage1" src = "https://shared.fastly.steamstatic.com/store_item_assets/steam/apps/2246340/header_292x136.jpg?t=1759120729"></a>

    </div>

    <div id = "wokes">

    <h1 id="isWoke">?</h1>

    <h1 id="isWoke1">?</h1>

    </div>

    <h2 id="score">0</h2>

    

    <table id="dataTable" border="1">
        <thead>
            <tr></tr> <!-- Will be filled with column names -->
        </thead>
        <tbody>
            <!-- Data rows will go here -->
        </tbody>
    </table>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
    <script>
        const csvFileUrl = 'data.csv'; 
        document.getElementById("next").style.display = '';
        var chosenIndex = 4;
        var chosenIndex1;
        var chosenWoke = 1;
        var chosenWoke1 = 0;
        var chosenImage;
        var chosenImage1;
        var myScore = 0;
        var answered = false;
        var reason;
        var reason1;
        var round = 0;
        var dateNumber = Date();
        var daySplit = dateNumber.split(" ");
        var myToday = daySplit[2];
        var dailyNum = "daily" + myToday;
       ;

        const thisMonth = {
        
            daily1: [[904, 59], [1229, 1479], [1093, 695], [727, 1175], [107, 236], [183, 537], [1067, 844], [68, 1318], [1188, 561], [1402, 613], [599, 600]],
            daily2: [[1138, 895], [1217, 1185], [535, 1136], [358, 993], [829, 531], [1235, 192], [234, 1313], [204, 18], [429, 197], [1526, 759], [599, 600]],
            daily3: [[1306, 550], [356, 156], [671, 1256], [367, 1413], [85, 1414], [183, 537], [1067, 844], [68, 1318], [1188, 561], [1402, 613], [599, 600]],
            daily4: [[904, 59], [1229, 1479], [1093, 695], [727, 1175], [107, 236], [183, 537], [1067, 844], [68, 1318], [1188, 561], [1402, 613], [599, 600]],
            daily5: [[1138, 895], [1217, 1185], [535, 1136], [358, 993], [829, 531], [1235, 192], [234, 1313], [204, 18], [429, 197], [1526, 759], [599, 600]],
            daily6: [[1306, 550], [356, 156], [671, 1256], [367, 1413], [85, 1414], [183, 537], [1067, 844], [68, 1318], [1188, 561], [1402, 613], [599, 600]],
            daily7: [[904, 59], [1229, 1479], [1093, 695], [727, 1175], [107, 236], [183, 537], [1067, 844], [68, 1318], [1188, 561], [1402, 613], [599, 600]],
            daily8: [[1138, 895], [1217, 1185], [535, 1136], [358, 993], [829, 531], [1235, 192], [234, 1313], [204, 18], [429, 197], [1526, 759], [599, 600]],
            daily9: [[1306, 550], [356, 156], [671, 1256], [367, 1413], [85, 1414], [183, 537], [1067, 844], [68, 1318], [1188, 561], [1402, 613], [599, 600]],
            daily10: [[904, 59], [1229, 1479], [1093, 695], [727, 1175], [107, 236], [183, 537], [1067, 844], [68, 1318], [1188, 561], [1402, 613], [599, 600]],
            daily11: [[1138, 895], [1217, 1185], [535, 1136], [358, 993], [829, 531], [1235, 192], [234, 1313], [204, 18], [429, 197], [1526, 759], [599, 600]],
            daily12: [[1306, 550], [356, 156], [671, 1256], [367, 1413], [85, 1414], [183, 537], [1067, 844], [68, 1318], [1188, 561], [1402, 613], [599, 600]],
            daily13: [[904, 59], [1229, 1479], [1093, 695], [727, 1175], [107, 236], [183, 537], [1067, 844], [68, 1318], [1188, 561], [1402, 613], [599, 600]],
            daily14: [[1138, 895], [1217, 1185], [535, 1136], [358, 993], [829, 531], [1235, 192], [234, 1313], [204, 18], [429, 197], [1526, 759], [599, 600]],
            daily15: [[1306, 550], [356, 156], [671, 1256], [367, 1413], [85, 1414], [183, 537], [1067, 844], [68, 1318], [1188, 561], [1402, 613], [599, 600]],
            daily16: [[904, 59], [1229, 1479], [1093, 695], [727, 1175], [107, 236], [183, 537], [1067, 844], [68, 1318], [1188, 561], [1402, 613], [599, 600]],
            daily17: [[1138, 895], [1217, 1185], [535, 1136], [358, 993], [829, 531], [1235, 192], [234, 1313], [204, 18], [429, 197], [1526, 759], [599, 600]],
            daily18: [[1306, 550], [356, 156], [671, 1256], [367, 1413], [85, 1414], [183, 537], [1067, 844], [68, 1318], [1188, 561], [1402, 613], [599, 600]],
            daily19: [[904, 59], [1229, 1479], [1093, 695], [727, 1175], [107, 236], [183, 537], [1067, 844], [68, 1318], [1188, 561], [1402, 613], [599, 600]],
            daily20: [[1138, 895], [1217, 1185], [535, 1136], [358, 993], [829, 531], [1235, 192], [234, 1313], [204, 18], [429, 197], [1526, 759], [599, 600]],
            daily21: [[1306, 550], [356, 156], [671, 1256], [367, 1413], [85, 1414], [183, 537], [1067, 844], [68, 1318], [1188, 561], [1402, 613], [599, 600]],
            daily22: [[904, 59], [1229, 1479], [1093, 695], [727, 1175], [107, 236], [183, 537], [1067, 844], [68, 1318], [1188, 561], [1402, 613], [599, 600]],
            daily23: [[1138, 895], [1217, 1185], [535, 1136], [358, 993], [829, 531], [1235, 192], [234, 1313], [204, 18], [429, 197], [1526, 759], [599, 600]],
            daily24: [[1306, 550], [356, 156], [671, 1256], [367, 1413], [85, 1414], [183, 537], [1067, 844], [68, 1318], [1188, 561], [1402, 613], [599, 600]],
            daily25: [[904, 59], [1229, 1479], [1093, 695], [727, 1175], [107, 236], [183, 537], [1067, 844], [68, 1318], [1188, 561], [1402, 613], [599, 600]],
            daily26: [[1138, 895], [1217, 1185], [535, 1136], [358, 993], [829, 531], [1235, 192], [234, 1313], [204, 18], [429, 197], [1526, 759], [599, 600]],
            daily27: [[1306, 550], [356, 156], [671, 1256], [367, 1413], [85, 1414], [183, 537], [1067, 844], [68, 1318], [1188, 561], [1402, 613], [599, 600]],
            daily28: [[904, 59], [1229, 1479], [1093, 695], [727, 1175], [107, 236], [183, 537], [1067, 844], [68, 1318], [1188, 561], [1402, 613], [599, 600]],
            daily29: [[1138, 895], [1217, 1185], [535, 1136], [358, 993], [829, 531], [1235, 192], [234, 1313], [204, 18], [429, 197], [1526, 759], [599, 600]],
            daily30: [[1306, 550], [356, 156], [671, 1256], [367, 1413], [85, 1414], [183, 537], [1067, 844], [68, 1318], [1188, 561], [1402, 613], [599, 600]],
            daily31: [[1306, 550], [356, 156], [671, 1256], [367, 1413], [85, 1414], [183, 537], [1067, 844], [68, 1318], [1188, 561], [1402, 613], [599, 600]],
       };
        var thisArray = thisMonth[dailyNum]
        fetch(csvFileUrl)
            .then(response => response.arrayBuffer())
            .then(data => {
                const workbook = XLSX.read(data, { type: 'array' });

                const sheetName = workbook.SheetNames[0]; 

                const sheet = workbook.Sheets[sheetName];  

                const jsonData = XLSX.utils.sheet_to_json(sheet, { header: 1 });  

                console.log(jsonData); //

                displayData(jsonData);
                displayRandomColumnData(jsonData, 1); 

                

                const randIndex = Math.floor(Math.random() * 1599) + 1;
            const randIndex1 = Math.floor(Math.random() * 1599) + 1;
            const randRow = jsonData[randIndex];
            const randRow1 = jsonData[randIndex1];
            const randData = randRow[1];
            const randData1 = randRow1[1];
            const thisWoke = randRow[3];
            const thisWoke1 = randRow1[3];
            if (thisWoke != thisWoke1) {
                console.log(randData);
                console.log(randData1);
                console.log(randIndex);
                console.log(randIndex1);
               
            }
          
            
            })
            .catch(error => {
                console.error('Error loading the Excel file:', error);
            });

        function displayData(data) {
            const table = document.getElementById("dataTable");
            const headerRow = table.querySelector("thead tr");
            const tbody = table.querySelector("tbody");

            
            headerRow.innerHTML = '';
            tbody.innerHTML = '';

            if (data.length > 0) {
                
                const header = data[0];
                header.forEach(column => {
                    const th = document.createElement("th");
                    th.textContent = column;
                    headerRow.appendChild(th);
                });

               
                data.slice(1).forEach(row => {
                    const tr = document.createElement("tr");
                    row.forEach(cell => {
                        const td = document.createElement("td");
                        td.textContent = cell;
                        tr.appendChild(td);
                    });
                    tbody.appendChild(tr);
                });
            }
        }

        function findDifferentWokes() {

          

            const randIndex = Math.floor(Math.random() * (data.length - 1)) + 1;
            const randIndex1 = Math.floor(Math.random() * (data.length - 1)) + 1;
            const randRow = jsonData[randIndex];
            const randRow1 = jsonData[randIndex1];
            const randData = randRow[1];
            const randData1 = randRow1[1];
            const thisWoke = randRow[3];
            const thisWoke1 = randRow[3];
            if (thisWoke != thisWoke1) {
                chosenWoke = thisWoke;
                chosenWoke1 = thisWoke1;
                debug.log(chosenWoke);
                debug.log(chosenWoke1);

            }
            
        }

        function displayRandomColumnData(data, columnIndex) {
            
             const thisRound = thisArray[round];
          const randomRowIndex = thisRound[0];
          const randomRowIndex1 = thisRound[1];
            chosenIndex = randomRowIndex;
            chosenIndex1 = randomRowIndex1;
            const randomRow = data[randomRowIndex];
            const randomRow1 = data[randomRowIndex1];
           
            const randomData = randomRow[columnIndex];
            const randomData1 = randomRow1[columnIndex];  
            chosenWoke = randomRow[3];
            chosenWoke1 = randomRow1[3];
            chosenImage = randomRow[2];
            chosenImage1 = randomRow1[2];
            reason = randomRow[4];
            reason1 = randomRow1[4];
           // var randomWoke = randomRow[2];
          
            const header = document.getElementById("header");
            //header.textContent = `${randomData}`;
            document.getElementById("myImage").src = chosenImage;
            document.getElementById("myImage1").src = chosenImage1;
          
          
        }

        function imgTest(ind) {
            document.getElementById("score").innerHTML = '' + myScore + "/10";
            if (answered == false && round <= 10) {
                answered = true;
                round += 1;
          const myRound = thisArray[round];
          const numOne = myRound[0];
          const numTwo = myRound[1];
               console.log(myScore);
          const myChoice = myRound[ind];
            if (ind == 0) {
               
                if (chosenWoke < chosenWoke1) {

                    console.log("you win");
                    document.getElementById("header").innerHTML = "correct";
                    document.getElementById("header").style.color = 'green';
                    myScore += 1;
                  
                }
                else {
                    console.log("you lose");
                    document.getElementById("header").innerHTML = "wrong";
                    document.getElementById("header").style.color = 'red';
                }

            }
            else {

                  if (chosenWoke > chosenWoke1) {

                    console.log("you win");
                    document.getElementById("header").innerHTML = "correct!";
                    document.getElementById("header").style.color = 'green';
                    myScore += 1;
                }
                else {
                    console.log("you lose");
                    document.getElementById("header").innerHTML = "wrong";
                    document.getElementById("header").style.color = 'red';
                }
            }
            
           }
           document.getElementById("isWoke").innerHTML = reason;
           document.getElementById("isWoke1").innerHTML = reason1;

           document.getElementById("score").innerHTML = '' + myScore + "/10";
           document.getElementById("next").style.display = '';
        }

        function buttonTest(answer) {
            if (answered == false) {
                if (round <= 10) {
                round += 1;
      //    header.textContent = chosenIndex;
         //   document.getElementById("header").innerHTML = answer;

            if ((chosenWoke == -1 && answer == chosenWoke) || (chosenWoke > -1 && answer > -1)) {

                document.getElementById("isWoke").innerHTML = "correct: " + reason;
                myScore += 1;
                document.getElementById("score").innerHTML = '' + myScore + "/10";
            }
            else {

                document.getElementById("isWoke").innerHTML = "wrong: " + reason;
                
                document.getElementById("score").innerHTML = '' + myScore + "/10";
            }
              if (chosenWoke == -1) {

            document.getElementById("myImage").style.border = '5px solid brown'; 
                }
                else if (chosenWoke == 0) {

                    document.getElementById("myImage").style.border = '5px solid chartreuse';

                }
                else if (chosenWoke == 1) {

                    document.getElementById("myImage").style.border = '5px solid chartreuse';

                }

            answered = true;
        }
    }
      
        }

        function refresh() {
          
            if (answered == true) {

            const workbook = XLSX.read(data, { type: 'array' });
                const sheetName = workbook.SheetNames[0];  
                const sheet = workbook.Sheets[sheetName];  
            const myjsonData = XLSX.utils.sheet_to_json(sheet, { header: 1 });
        displayRandomColumnData(myjsonData, 1);
        answered = false;
            }
        }

            function myrefresh() {
                
    if (round == 10) {

            alert("good job!" + "score = " + myScore);

        }
        else {
                if (answered == true) {
            fetch(csvFileUrl)
            .then(response => response.arrayBuffer())
            .then(data => {
                const workbook = XLSX.read(data, { type: 'array' });
                const sheetName = workbook.SheetNames[0];  // Get the first sheet name
                const sheet = workbook.Sheets[sheetName];  // Get the first sheet data
                const jsonData = XLSX.utils.sheet_to_json(sheet, { header: 1 });  // Convert to JSON array

                console.log(jsonData); // Log the data for inspection
                displayData(jsonData);
                displayRandomColumnData(jsonData, 1); // Pass the column index (e.g., 1 for the second column)
            })
            .catch(error => {
                console.error('Error loading the Excel file:', error);
            });
             document.getElementById("myImage").style.border = '5px solid black';
            document.getElementById("isWoke").innerHTML = "?";
            document.getElementById("isWoke1").innerHTML = "?";
            answered = false;
            document.getElementById("next").style.display = 'none';
            document.getElementById("header").innerHTML = "which is woker?";
            document.getElementById("header").style.color = 'black';
        }
            }
        }
    </script>
</body>
</html>
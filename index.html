<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Load Excel Data</title>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Bungee&display=swap" rel="stylesheet">

    <style>

.bungee-regular {
  font-family: "Bungee", sans-serif;
  font-weight: 400;
  font-style: normal;
}


#dataTable {


display:none;

}

body {

background-image: url("images/gradient.jpg");

background-size: cover;

background-repeat:no-repeat;


}

#myImage {

position:relative;
margin-top:10%;
left: 50%;
right: 50%;
transform: translate(-50%, -50%);
height: 30%;
width: 30%;
border-color: black;
border-radius: 2%;
border: 5px solid black;
margin-bottom: -3%;
display: none;
}

#header {
  
max-width: 1080px;      
margin: 0 auto;        
text-align: center;    
white-space: normal;   
word-break: normal;    
margin-top: 3%;
font-family:"Bungee";
font-size:50px;
}

#isWoke {


max-width: 600px;      
margin: 0 auto;        
text-align: center;    
white-space: normal;   
word-break: normal;    
margin-top: 1%;
font-family:"Bungee";
font-size:16px;
}

#score {

max-width: 600px;      
margin: 0 auto;        
text-align: center;    
white-space: normal;   
word-break: normal;    
margin-top: 2%;
font-family:"Bungee";
font-size:30px;

}

#buttons {

max-width: 400px;      
margin: 0 auto;        
text-align: center;    
white-space: normal;   
word-break: normal;    
margin-top: 2%;
font-family:"Bungee";

}

#yes {


font-family:"Bungee";
background-color: brown;
font-size:20px;
display: inline-block;
 padding: 15px 32px;
}

#next {


font-family:"Bungee";
background-color: white;
font-size:20px;
display: inline-block;
 padding: 15px 32px;
 margin-left: 2%;

}

#maybe {
font-size:20px;
font-family:"Bungee";
background-color: chartreuse;
display: inline-block;
 padding: 15px 32px;
 margin-left: 2%;
}

#no {
font-size:20px;
font-family:"Bungee";
background-color:gold;
display: inline-block;
 padding: 15px 32px;
 margin-left: 2%;
}

#quantity {
position:relative;
align-content: center;
max-width: 600px;      
margin: 0 auto;        
text-align: center;    
white-space: normal;   
word-break: normal;    
margin-top: 2%;
font-family:"Bungee";
font-size:16px;

}

#wagerLabel {

position:relative;
align-content: center;
max-width: 600px;      
margin: 0 auto;        
text-align: center;    
white-space: normal;   
word-break: normal;    
margin-top: 2%;
font-family:"Bungee";
font-size:16px;


}

    </style>
</head>


<body>
    <h1 id="header">Is it Woke?</h1>
    
    <div id = "buttons">

    <a href="wokele.html"><button href="wokele.html" id = "yes">Play The Wokele! (A)</button></a>

    <a href="whichiswoker.html"><button href="whichiswoker.html" id = "no">Play the The Wokele! (B)</button></a>

    <a href="streak.html"><button href="streak.html" id = "maybe">Endless</button></a>

    <a href="gamblingMode.html"><button href="gamblingMode.html" id = "next">Gambling Mode</button></a>

   </div>

    <img id = "myImage" class = "theImage" src = "https://shared.fastly.steamstatic.com/store_item_assets/steam/apps/2246340/header_292x136.jpg?t=1759120729">

    

    

    <h1 id="isWoke">?</h1>

    <h2 id="score">10</h2>

    <table id="dataTable" border="1">
        <thead>
            <tr></tr> <!-- Will be filled with column names -->
        </thead>
        <tbody>
            <!-- Data rows will go here -->
        </tbody>
    </table>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
    <script>
        const csvFileUrl = 'data.csv'; 
        var chosenIndex = 4;
        var chosenWoke = 6;
        var chosenImage;
        var myScore = 10;
        var thisWager;
        var answered = false;
        var reason;
        var verdict;
       
        fetch(csvFileUrl)
            .then(response => response.arrayBuffer())
            .then(data => {
                const workbook = XLSX.read(data, { type: 'array' });

                const sheetName = workbook.SheetNames[0]; 

                const sheet = workbook.Sheets[sheetName];  

                const jsonData = XLSX.utils.sheet_to_json(sheet, { header: 1 });  

                console.log(jsonData); //

               
            })
            .catch(error => {
                console.error('Error loading the Excel file:', error);
            });

        function displayData(data) {
            const table = document.getElementById("dataTable");
            const headerRow = table.querySelector("thead tr");
            const tbody = table.querySelector("tbody");

            
            headerRow.innerHTML = '';
            tbody.innerHTML = '';

            if (data.length > 0) {
                
                const header = data[0];
                header.forEach(column => {
                    const th = document.createElement("th");
                    th.textContent = column;
                    headerRow.appendChild(th);
                });

               
                data.slice(1).forEach(row => {
                    const tr = document.createElement("tr");
                    row.forEach(cell => {
                        const td = document.createElement("td");
                        td.textContent = cell;
                        tr.appendChild(td);
                    });
                    tbody.appendChild(tr);
                });
            }
        }

        function displayRandomColumnData(data, columnIndex) {
         
            const randomRowIndex = Math.floor(Math.random() * (data.length - 1)) + 1;
            chosenIndex = randomRowIndex;
            const randomRow = data[randomRowIndex];
            
           
            const randomData = randomRow[columnIndex];  
            chosenWoke = randomRow[3];
            chosenImage = randomRow[2];
            reason = randomRow[4];
           // var randomWoke = randomRow[2];
          
            const header = document.getElementById("header");
            header.textContent = `${randomData}`;
            document.getElementById("myImage").src = chosenImage
          
        }

        function buttonTest(answer) {

            if (answered == false) {

            if (Number(document.getElementById("quantity").value) > 9) {

                alert("Cannot wager more than 10 points");
                thisWager = 0;
            }
            else {
                 thisWager = Number(document.getElementById("quantity").value);
            }
           
      //    header.textContent = chosenIndex;
      

            if (answer == chosenWoke) {
                verdict = "correct: ";
                if (answer == -1) {

                     myScore += (2 + thisWager);
                }
                else {

                    myScore += (5 + thisWager);
                }
                document.getElementById("isWoke").innerHTML = verdict + reason;
               
                document.getElementById("score").innerHTML = '' + myScore;
            }
            else {
                verdict = "wrong: ";
                if (answer == -1) {
                    if (myScore > 1) {
                    myScore -= (2 + thisWager);
                        }
                }
                else {
                    if (myScore > 4) {
                    myScore -= (5 + thisWager);
                    }
                }
                document.getElementById("isWoke").innerHTML = verdict + reason;
                
                document.getElementById("score").innerHTML = '' + myScore;
            }

            if (chosenWoke == -1) {

            document.getElementById("myImage").style.border = '5px solid brown'; 
                }
                else if (chosenWoke == 0) {

                    document.getElementById("myImage").style.border = '5px solid gold';

                }
                else if (chosenWoke == 1) {

                    document.getElementById("myImage").style.border = '5px solid chartreuse';

                }

            answered = true;
        }
        }
        function refresh() {
            const workbook = XLSX.read(data, { type: 'array' });
                const sheetName = workbook.SheetNames[0];  
                const sheet = workbook.Sheets[sheetName];  
            const myjsonData = XLSX.utils.sheet_to_json(sheet, { header: 1 });
        displayRandomColumnData(myjsonData, 1);

        }

        function myWager() {

           thisWager = Number(document.getElementById("quantity").value);

         
        }
            function myrefresh() {

                if (answered == true) {

            fetch(csvFileUrl)
            .then(response => response.arrayBuffer())
            .then(data => {
                const workbook = XLSX.read(data, { type: 'array' });
                const sheetName = workbook.SheetNames[0];  // Get the first sheet name
                const sheet = workbook.Sheets[sheetName];  // Get the first sheet data
                const jsonData = XLSX.utils.sheet_to_json(sheet, { header: 1 });  // Convert to JSON array

                console.log(jsonData); // Log the data for inspection
                displayData(jsonData);
                displayRandomColumnData(jsonData, 1); // Pass the column index (e.g., 1 for the second column)
            })
            .catch(error => {
                console.error('Error loading the Excel file:', error);
            });

            answered = false;
            document.getElementById("myImage").style.border = '5px solid black';
            document.getElementById("isWoke").innerHTML = "?";
            }

        }
    </script>
</body>
</html>